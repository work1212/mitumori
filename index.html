<!DOCTYPE html>

<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>クーリク お見積もり</title>
<link href="https://fonts.googleapis.com/css2?family=Noto+Serif+JP:wght@300;400;700&family=Noto+Sans+JP:wght@300;400;500;700&display=swap" rel="stylesheet">
<style>
 :root {
 --cream: #faf7f2;
 --warm-white: #fff9f0;
 --brown: #5c3d2e;
 --brown-light: #8b6347;
 --gold: #c9973a;
 --gold-light: #e8c47a;
 --sage: #7a9e7e;
 --rose: #d4826a;
 --dark: #2a1f15;
 --shadow: rgba(92,61,46,0.12);
 }
 * { box-sizing: border-box; margin: 0; padding: 0; }
 body { font-family: 'Noto Sans JP', sans-serif; background: var(--cream); color: var(--dark); min-height: 100vh; }

.header {
background: var(–brown); padding: 20px 40px;
display: flex; align-items: center; gap: 16px;
position: sticky; top: 0; z-index: 100;
box-shadow: 0 2px 20px rgba(0,0,0,0.2);
}
.header-paw { font-size: 28px; animation: bounce 2s infinite; }
@keyframes bounce { 0%,100%{transform:translateY(0)} 50%{transform:translateY(-4px)} }
.header h1 { font-family:‘Noto Serif JP’,serif; color:var(–gold-light); font-size:22px; font-weight:700; letter-spacing:0.08em; }
.header p { color:rgba(255,255,255,0.6); font-size:12px; margin-left:auto; }

.container { max-width: 920px; margin: 0 auto; padding: 36px 20px 80px; }

.card {
background: var(–warm-white); border-radius: 16px; padding: 26px 30px;
margin-bottom: 18px; border: 1px solid rgba(92,61,46,0.1);
box-shadow: 0 4px 20px var(–shadow); transition: box-shadow 0.3s;
}
.card:hover { box-shadow: 0 8px 32px var(–shadow); }

.section-title {
font-family:‘Noto Serif JP’,serif; font-size:17px; color:var(–brown); font-weight:700;
margin-bottom:6px; display:flex; align-items:center; gap:10px;
}
.section-title::before { content:’’; display:block; width:4px; height:20px; background:var(–gold); border-radius:2px; }
.section-sub { font-size:12px; color:var(–brown-light); margin-bottom:16px; padding-left:14px; }

.field-row { display:grid; grid-template-columns:1fr 1fr; gap:14px; margin-bottom:14px; }
.field label { display:block; font-size:12px; color:var(–brown-light); margin-bottom:5px; font-weight:500; }
.field input[type=“number”], .field input[type=“text”] {
width:100%; padding:10px 14px; border:1.5px solid rgba(92,61,46,0.2);
border-radius:10px; font-family:‘Noto Sans JP’,sans-serif; font-size:14px;
color:var(–dark); background:white; outline:none; transition:border-color 0.2s,box-shadow 0.2s;
}
.field input:focus { border-color:var(–gold); box-shadow:0 0 0 3px rgba(201,151,58,0.12); }

.staff-row { display:flex; align-items:center; gap:12px; margin-bottom:18px; }
.staff-row label { font-size:13px; color:var(–brown-light); min-width:88px; }
.staff-row input {
flex:1; padding:10px 14px; border:1.5px solid rgba(92,61,46,0.2); border-radius:10px;
font-family:‘Noto Sans JP’,sans-serif; font-size:14px; outline:none; background:white; transition:border-color 0.2s;
}
.staff-row input:focus { border-color:var(–gold); }

.chip-group { display:flex; flex-wrap:wrap; gap:8px; margin-bottom:4px; }
.chip {
padding:8px 14px; border-radius:50px; font-size:12px; font-weight:500;
cursor:pointer; border:1.5px solid rgba(92,61,46,0.2); background:white;
color:var(–brown-light); transition:all 0.2s; user-select:none;
font-family:‘Noto Sans JP’,sans-serif; text-align:center; line-height:1.5;
}
.chip:hover { border-color:var(–gold); color:var(–gold); }
.chip.active { background:var(–brown); border-color:var(–brown); color:white; }

.sub-label { font-size:12px; color:var(–brown-light); margin-bottom:8px; font-weight:500; }

.food-weight-grid { display:grid; grid-template-columns:repeat(3,1fr); gap:8px; margin-bottom:10px; }
.weight-chip {
padding:10px 8px; text-align:center; border-radius:12px; font-size:13px; font-weight:500;
cursor:pointer; border:1.5px solid rgba(92,61,46,0.2); background:white;
color:var(–brown-light); transition:all 0.2s; user-select:none; font-family:‘Noto Sans JP’,sans-serif;
}
.weight-chip:hover { border-color:var(–sage); color:var(–sage); }
.weight-chip.active { background:var(–sage); border-color:var(–sage); color:white; }
.weight-chip span { display:block; font-size:10px; opacity:0.8; margin-top:2px; }

.cap-badge {
display:inline-block; margin-top:10px;
background:rgba(201,151,58,0.12); border:1px solid rgba(201,151,58,0.3);
color:var(–gold); font-size:11px; padding:4px 14px; border-radius:50px; font-weight:600;
}

.tip-box {
background:rgba(201,151,58,0.08); border-left:3px solid var(–gold);
padding:10px 14px; border-radius:0 8px 8px 0;
font-size:11.5px; color:var(–brown-light); margin-top:14px; line-height:1.8;
}
.tip-rose {
background:rgba(212,130,106,0.08); border-left:3px solid var(–rose);
padding:10px 14px; border-radius:0 8px 8px 0;
font-size:11.5px; color:var(–brown-light); margin-top:10px; line-height:1.8;
}

.plan-grid { display:grid; grid-template-columns:repeat(3,1fr); gap:14px; margin-top:8px; }
@media(max-width:680px){
.plan-grid{grid-template-columns:1fr;}
.field-row{grid-template-columns:1fr;}
.food-weight-grid{grid-template-columns:repeat(3,1fr);}
}

.plan-card { border-radius:14px; overflow:hidden; border:1.5px solid rgba(92,61,46,0.1); background:white; }
.plan-card:nth-child(1) { border-top:4px solid var(–brown-light); }
.plan-card:nth-child(2) { border-top:4px solid var(–sage); }
.plan-card:nth-child(3) { border-top:4px solid var(–rose); }

.plan-header { padding:14px 16px 10px; }
.plan-header h3 { font-family:‘Noto Serif JP’,serif; font-size:13px; font-weight:700; margin-bottom:3px; }
.plan-card:nth-child(1) .plan-header h3 { color:var(–brown-light); }
.plan-card:nth-child(2) .plan-header h3 { color:var(–sage); }
.plan-card:nth-child(3) .plan-header h3 { color:var(–rose); }
.plan-sublabel { font-size:10px; font-weight:600; }
.plan-card:nth-child(2) .plan-sublabel { color:var(–sage); }
.plan-card:nth-child(3) .plan-sublabel { color:var(–rose); }

.plan-body { padding:0 14px 14px; }
.plan-row { display:flex; justify-content:space-between; align-items:center; padding:5px 0; border-bottom:1px solid rgba(92,61,46,0.06); font-size:11px; }
.plan-row:last-child { border-bottom:none; }
.plan-row .nm { color:var(–brown-light); }
.plan-row .vl { font-weight:600; color:var(–dark); }
.plan-row .vl.neg { color:var(–rose); }

.plan-total { background:rgba(92,61,46,0.04); border-radius:10px; padding:11px; margin-top:10px; text-align:center; }
.plan-total .lbl { font-size:10px; color:var(–brown-light); margin-bottom:4px; }
.plan-total .amt { font-family:‘Noto Serif JP’,serif; font-size:20px; font-weight:700; color:var(–brown); }

.plan3-sep { margin-top:10px; border-top:1px dashed rgba(212,130,106,0.4); padding-top:10px; }
.plan3-sep .sep-lbl { font-size:10px; color:var(–rose); font-weight:700; margin-bottom:6px; }

.print-btn {
display:block; width:100%; padding:14px; background:var(–brown); color:white;
border:none; border-radius:12px; font-family:‘Noto Sans JP’,sans-serif; font-size:14px; font-weight:700;
cursor:pointer; letter-spacing:0.05em; transition:background 0.2s,transform 0.1s; margin-top:10px;
}
.print-btn:hover { background:var(–dark); transform:translateY(-1px); }

/* スキップローンセクション */
.skip-section {
margin-top: 24px;
border-top: 2px dashed rgba(92,61,46,0.15);
padding-top: 20px;
}
.skip-header {
display: flex; align-items: center; gap: 10px; margin-bottom: 14px;
}
.skip-title {
font-family:‘Noto Serif JP’,serif; font-size:16px; color:var(–brown); font-weight:700;
}
.recommend-badge {
background: linear-gradient(135deg, var(–gold), #e8a820);
color: white; font-size:11px; font-weight:700;
padding: 3px 10px; border-radius: 50px; letter-spacing:0.03em;
}
.skip-grid {
display: grid; grid-template-columns: 1fr 1fr; gap: 14px;
}
@media(max-width:680px){ .skip-grid{grid-template-columns:1fr;} }

.skip-card {
border-radius: 14px; border: 1.5px solid rgba(201,151,58,0.3);
background: linear-gradient(135deg, #fffdf7, #fff9ee);
overflow: hidden;
}
.skip-card.combo {
border-color: rgba(212,130,106,0.4);
background: linear-gradient(135deg, #fff8f6, #fff2ee);
}
.skip-card-header {
padding: 12px 16px 8px;
border-bottom: 1px solid rgba(201,151,58,0.15);
}
.skip-card.combo .skip-card-header {
border-bottom-color: rgba(212,130,106,0.2);
}
.skip-card-header h4 {
font-family:‘Noto Serif JP’,serif; font-size:13px; font-weight:700; color:var(–gold); margin-bottom:2px;
}
.skip-card.combo .skip-card-header h4 { color: var(–rose); }
.skip-card-header .sub { font-size:10px; color:var(–brown-light); }
.skip-card-body { padding: 10px 16px 14px; }
.skip-row {
display:flex; justify-content:space-between; align-items:center;
padding: 5px 0; border-bottom:1px solid rgba(92,61,46,0.06); font-size:11px;
}
.skip-row:last-child { border-bottom:none; }
.skip-row .nm { color:var(–brown-light); }
.skip-row .vl { font-weight:600; color:var(–dark); }
.skip-row .vl.neg { color:var(–rose); }
.skip-row .vl.gold { color:var(–gold); font-weight:700; }
.skip-total {
background: rgba(201,151,58,0.08); border-radius:10px;
padding:11px; margin-top:10px; text-align:center;
border: 1px solid rgba(201,151,58,0.2);
}
.skip-card.combo .skip-total {
background: rgba(212,130,106,0.07);
border-color: rgba(212,130,106,0.2);
}
.skip-total .lbl { font-size:10px; color:var(–brown-light); margin-bottom:4px; }
.skip-total .amt { font-family:‘Noto Serif JP’,serif; font-size:20px; font-weight:700; }
.skip-card .skip-total .amt { color: var(–gold); }
.skip-card.combo .skip-total .amt { color: var(–rose); }
.skip-note {
display:flex; align-items:flex-start; gap:6px;
background: rgba(122,158,126,0.08); border:1px solid rgba(122,158,126,0.2);
border-radius:8px; padding:8px 12px; margin-top:8px; font-size:10.5px;
color:var(–brown-light); line-height:1.6;
}
.skip-note .icon { font-size:13px; flex-shrink:0; margin-top:1px; }
.skip-tag {
display:inline-block; margin-right:4px; margin-bottom:4px;
background:rgba(122,158,126,0.12); border:1px solid rgba(122,158,126,0.3);
color:var(–sage); font-size:10px; font-weight:600;
padding:2px 8px; border-radius:50px;
}
.ng-tag {
background:rgba(212,130,106,0.12); border-color:rgba(212,130,106,0.3); color:var(–rose);
}

@media print {
.header{position:static;} .no-print{display:none;}
.card{box-shadow:none;border:1px solid #ddd;break-inside:avoid;}
}
</style>

</head>
<body>

<div class="header">
 <span class="header-paw"> </span>
 <h1>クーリク お見積もりシステム</h1>
 <p>担当：<span id="staffDisplay">—</span></p>
</div>

<div class="container">

 <!-- 基本情報 -->

 <div class="card">
 <div class="section-title">基本情報</div>
 <div class="section-sub">担当者名と生体情報を入力してください</div>
 <div class="staff-row">
 <label>お見積担当</label>
 <input type="text" id="staff" placeholder="例：佐藤" oninput="document.getElementById('staffDisplay').textContent=this.value||'—';calc()">
 </div>
 <div class="field-row">
 <div class="field">
 <label>生体番号</label>
 <input type="text" id="seibanumber" placeholder="例：A-001" oninput="calc()">
 </div>
 <div class="field">
 <label>生体名（種別）</label>
 <input type="text" id="seibaname" placeholder="例：マンチカン" oninput="calc()">
 </div>
 </div>
 <div class="field-row">
 <div class="field">
 <label>生体価格（円・税抜）</label>
 <input type="number" id="price" placeholder="例：300000" oninput="calc()" min="0" step="1000">
 </div>
 <div class="field">
 <label>犬籍・狂犬病登録手数料（円）</label>
 <input type="number" id="kenreg" placeholder="0" oninput="calc()" min="0" value="0">
 </div>
 </div>
 </div>

 <!-- ワクチン -->

 <div class="card">
 <div class="section-title">② ワクチン回数（安心パック）</div>
 <div class="section-sub">ワクチン代・マイクロチップ・遺伝子病検査1項目込み</div>
 <div class="chip-group" id="vaccineGroup">
 <div class="chip active" data-val="ワクチン1回" onclick="selectChip(this,'vaccineGroup','vaccine')">ワクチン1回<br><small>¥68,000</small></div>
 <div class="chip" data-val="ワクチン2回" onclick="selectChip(this,'vaccineGroup','vaccine')">ワクチン2回<br><small>¥75,000</small></div>
 <div class="chip" data-val="ワクチン3回" onclick="selectChip(this,'vaccineGroup','vaccine')">ワクチン3回<br><small>¥82,000</small></div>
 </div>
 </div>

 <!-- 生命保障 -->

 <div class="card">
 <div class="section-title">③ 生命保障期間</div>
 <div class="section-sub">病気や怪我で万一の際の保障（生体価格＋安心パック合計に対しての割合）</div>
 <div class="chip-group" id="lifeGroup">
 <div class="chip" data-val="1ヵ月" onclick="selectChip(this,'lifeGroup','life')">1ヵ月<br><small>10%</small></div>
 <div class="chip" data-val="3ヵ月" onclick="selectChip(this,'lifeGroup','life')">3ヵ月<br><small>15%</small></div>
 <div class="chip" data-val="6ヵ月" onclick="selectChip(this,'lifeGroup','life')">6ヵ月<br><small>20%</small></div>
 <div class="chip" data-val="12ヵ月" onclick="selectChip(this,'lifeGroup','life')">12ヵ月<br><small>25%</small></div>
 <div class="chip active" data-val="24ヵ月" onclick="selectChip(this,'lifeGroup','life')">24ヵ月<br><small>30%</small></div>
 <div class="chip" data-val="36ヵ月" onclick="selectChip(this,'lifeGroup','life')">36ヵ月<br><small>35%</small></div>
 <div class="chip" data-val="60ヵ月" onclick="selectChip(this,'lifeGroup','life')">60ヵ月<br><small>40%</small></div>
 <div class="chip" data-val="100ヵ月" onclick="selectChip(this,'lifeGroup','life')">100ヵ月<br><small>50%</small></div>
 </div>
 </div>

 <!-- 遺伝子検査 -->

 <div class="card">
 <div class="section-title">④⑤ 遺伝子検査オプション</div>
 <div style="margin-bottom:18px">
 <div class="sub-label">追加遺伝子検査</div>
 <div class="chip-group" id="geneGroup">
 <div class="chip active" data-val="追加項目なし" onclick="selectChip(this,'geneGroup','gene')">追加なし<br><small>¥0</small></div>
 <div class="chip" data-val="追加1項目" onclick="selectChip(this,'geneGroup','gene')">追加1項目<br><small>¥5,000</small></div>
 <div class="chip" data-val="追加2項目" onclick="selectChip(this,'geneGroup','gene')">追加2項目<br><small>¥8,000</small></div>
 </div>
 </div>
 <div>
 <div class="sub-label">遺伝子検査証明書</div>
 <div class="chip-group" id="certGroup">
 <div class="chip active" data-val="対象外" onclick="selectChip(this,'certGroup','cert')">対象外<br><small>¥0</small></div>
 <div class="chip" data-val="検査有" onclick="selectChip(this,'certGroup','cert')">検査有<br><small>¥1,000</small></div>
 </div>
 </div>
 </div>

 <!-- フードコース -->

 <div class="card">
 <div class="section-title"> フードコース選択</div>
 <div class="section-sub">成犬時の体重目安、または猫を選択してください。割引上限が変わります。</div>

```
<div class="food-weight-grid" id="weightGroup">
 <div class="weight-chip active" data-cap="80000" onclick="selectWeight(this,'猫',80000)"> 猫<span>上限 8万円</span></div>
 <div class="weight-chip" data-cap="80000" onclick="selectWeight(this,'3kg',80000)">3kg<span>上限 8万円</span></div>
 <div class="weight-chip" data-cap="80000" onclick="selectWeight(this,'5kg',80000)">5kg<span>上限 8万円</span></div>
 <div class="weight-chip" data-cap="80000" onclick="selectWeight(this,'8kg',80000)">8kg<span>上限 8万円</span></div>
 <div class="weight-chip" data-cap="80000" onclick="selectWeight(this,'10kg',80000)">10kg<span>上限 8万円</span></div>
 <div class="weight-chip" data-cap="160000" onclick="selectWeight(this,'15kg',160000)">15kg<span>上限 16万円</span></div>
 <div class="weight-chip" data-cap="160000" onclick="selectWeight(this,'20kg',160000)">20kg<span>上限 16万円</span></div>
 <div class="weight-chip" data-cap="200000" onclick="selectWeight(this,'30kg',200000)">30kg<span>上限 20万円</span></div>
 <div class="weight-chip" data-cap="200000" onclick="selectWeight(this,'40kg',200000)">40kg<span>上限 20万円</span></div>
</div>

<div id="capBadge" class="cap-badge"> 現在の割引上限：¥80,000（猫・〜10kg）</div>

<div style="margin-top:22px">
 <div class="sub-label">フード定期プランの期間（②プランで適用）</div>
 <div class="chip-group" id="foodGroup">
 <div class="chip active" data-val="5年プラン" onclick="selectChip(this,'foodGroup','food')">5年プラン<br><small>50%割引</small></div>
 <div class="chip" data-val="3年プラン" onclick="selectChip(this,'foodGroup','food')">3年プラン<br><small>15%割引</small></div>
 <div class="chip" data-val="1年プラン" onclick="selectChip(this,'foodGroup','food')">1年プラン<br><small>5%割引</small></div>
 <div class="chip" data-val="なし" onclick="selectChip(this,'foodGroup','food')">プランなし</div>
 </div>
</div>

<div class="tip-box">
 ★ 定期プラン5年：（生体価格＋安心パック）×50% 割引（上限キャップあり）<br>
 ★ 定期プラン3年：生体価格 ×15% 割引（上限キャップあり）<br>
 ★ 定期プラン1年：生体価格 ×5% 割引（上限キャップあり）
</div>
<div class="tip-rose">
 ★ あんしんMAX70%割：フード5年割引後の残額にさらに25%引き ＋ 生命保障はカード払い分離<br>
 ※ フード定期プラン・あんしんMAX70%割はクレジットカード必須（デビット・バンドル不可）
</div>
```

 </div>

 <!-- 結果 -->

 <div class="card">
 <div class="section-title"> お見積もり結果</div>
 <div class="section-sub" id="resultSubtitle">生体名：— ｜ 担当：— ｜ フードコース：—</div>

```
<div class="plan-grid">

 <!-- Plan 1 -->
 <div class="plan-card">
 <div class="plan-header">
 <h3>① 割引なしプラン</h3>
 <div class="plan-sublabel" style="color:#bbb">標準プラン</div>
 </div>
 <div class="plan-body">
 <div class="plan-row"><span class="nm">生体価格</span><span class="vl" id="p1-seiba">—</span></div>
 <div class="plan-row"><span class="nm">安心パック</span><span class="vl" id="p1-pack">—</span></div>
 <div class="plan-row"><span class="nm">生命保障</span><span class="vl" id="p1-life">—</span></div>
 <div class="plan-row"><span class="nm">追加遺伝検査</span><span class="vl" id="p1-gene">—</span></div>
 <div class="plan-row"><span class="nm">遺伝子証明書</span><span class="vl" id="p1-cert">—</span></div>
 <div class="plan-row"><span class="nm">犬籍・狂犬病</span><span class="vl" id="p1-ken">—</span></div>
 <div class="plan-row"><span class="nm">小計</span><span class="vl" id="p1-sub">—</span></div>
 <div class="plan-row"><span class="nm">消費税(10%)</span><span class="vl" id="p1-tax">—</span></div>
 <div class="plan-total">
 <div class="lbl">合計（税込）</div>
 <div class="amt" id="p1-total">—</div>
 </div>
 </div>
 </div>

 <!-- Plan 2 -->
 <div class="plan-card">
 <div class="plan-header">
 <h3>② フード定期プラン</h3>
 <div class="plan-sublabel" id="p2-planlabel">5年プラン 50%割引</div>
 </div>
 <div class="plan-body">
 <div class="plan-row"><span class="nm">生体価格</span><span class="vl" id="p2-seiba">—</span></div>
 <div class="plan-row"><span class="nm">安心パック</span><span class="vl" id="p2-pack">—</span></div>
 <div class="plan-row"><span class="nm">生命保障</span><span class="vl" id="p2-life">—</span></div>
 <div class="plan-row"><span class="nm">追加遺伝検査</span><span class="vl" id="p2-gene">—</span></div>
 <div class="plan-row"><span class="nm">遺伝子証明書</span><span class="vl" id="p2-cert">—</span></div>
 <div class="plan-row"><span class="nm">犬籍・狂犬病</span><span class="vl" id="p2-ken">—</span></div>
 <div class="plan-row"><span class="nm">小計</span><span class="vl" id="p2-sub">—</span></div>
 <div class="plan-row"><span class="nm">消費税(10%)</span><span class="vl" id="p2-tax">—</span></div>
 <div class="plan-row"><span class="nm">フード割引</span><span class="vl neg" id="p2-disc">—</span></div>
 <div class="plan-total">
 <div class="lbl">合計（税込）</div>
 <div class="amt" id="p2-total">—</div>
 </div>
 </div>
 </div>

 <!-- Plan 3 -->
 <div class="plan-card">
 <div class="plan-header">
 <h3>③ あんしんMAX70%割</h3>
 <div class="plan-sublabel"> オススメ！！</div>
 </div>
 <div class="plan-body">
 <div class="plan-row"><span class="nm">生体価格</span><span class="vl" id="p3-seiba">—</span></div>
 <div class="plan-row"><span class="nm">安心パック</span><span class="vl" id="p3-pack">—</span></div>
 <div class="plan-row"><span class="nm">追加遺伝検査</span><span class="vl" id="p3-gene">—</span></div>
 <div class="plan-row"><span class="nm">遺伝子証明書</span><span class="vl" id="p3-cert">—</span></div>
 <div class="plan-row"><span class="nm">犬籍・狂犬病</span><span class="vl" id="p3-ken">—</span></div>
 <div class="plan-row"><span class="nm">小計</span><span class="vl" id="p3-sub">—</span></div>
 <div class="plan-row"><span class="nm">消費税(10%)</span><span class="vl" id="p3-tax">—</span></div>
 <div class="plan-row"><span class="nm">フード割引(50%)</span><span class="vl neg" id="p3-fooddisc">—</span></div>
 <div class="plan-row"><span class="nm">MAX70%割引</span><span class="vl neg" id="p3-maxdisc">—</span></div>
 <div class="plan-total">
 <div class="lbl">お迎え当日精算（税込）</div>
 <div class="amt" id="p3-daytotal">—</div>
 </div>
 <div class="plan3-sep">
 <div class="sep-lbl">＋ 生命保障カード払い分（別途・100ヵ月固定）</div>
 <div class="plan-row"><span class="nm">生命保障（税込）</span><span class="vl" id="p3-life">—</span></div>
 <div class="plan-total" style="background:rgba(212,130,106,0.07)">
 <div class="lbl">当日精算＋生命保障 合計</div>
 <div class="amt" style="color:var(--rose);font-size:18px" id="p3-grandtotal">—</div>
 </div>
 </div>
 </div>
 </div>

</div>


<!-- スキップローンセクション -->
<div class="skip-section">
 <div class="skip-header">
 <div class="skip-title"> スキップローン</div>
 <span class="recommend-badge"> オススメ</span>
 </div>
 <div style="font-size:11px;color:var(--brown-light);margin-bottom:14px;padding-left:2px;">
 <span class="skip-tag">金利・手数料無料</span>
 <span class="skip-tag">3ヶ月後払いスタート</span>
 <span class="skip-tag">生保100ヵ月必須</span>
 <span class="skip-tag">フード定期併用可</span>
 <span class="skip-tag ng-tag">あんしんMAXとの併用不可</span>
 </div>
 <div class="skip-grid">

 <!-- スキップA: 割引なし＋スキップ -->
 <div class="skip-card">
 <div class="skip-card-header">
 <h4>① 割引なし ＋ スキップローン</h4>
 <div class="sub">生保100ヵ月固定 ／ 3ヶ月後払いスタート</div>
 </div>
 <div class="skip-card-body">
 <div class="skip-row"><span class="nm">お迎え当日（税込）</span><span class="vl" id="sk1-day">—</span></div>
 <div class="skip-row"><span class="nm">生命保障（100ヵ月・税込）</span><span class="vl" id="sk1-life">—</span></div>
 <div class="skip-row"><span class="nm">金利・手数料</span><span class="vl gold">無料</span></div>
 <div class="skip-row"><span class="nm">お支払い開始</span><span class="vl gold">3ヶ月後〜</span></div>
 <div class="skip-total">
 <div class="lbl">当日＋生命保障 合計（税込）</div>
 <div class="amt" id="sk1-total">—</div>
 </div>
 </div>
 </div>

 <!-- スキップB: フード定期＋スキップ -->
 <div class="skip-card">
 <div class="skip-card-header">
 <h4>② フード定期 ＋ スキップローン</h4>
 <div class="sub">生保100ヵ月固定 ／ フード割引適用</div>
 </div>
 <div class="skip-card-body">
 <div class="skip-row"><span class="nm">フード割引</span><span class="vl neg" id="sk2-disc">—</span></div>
 <div class="skip-row"><span class="nm">お迎え当日（割引後・税込）</span><span class="vl" id="sk2-day">—</span></div>
 <div class="skip-row"><span class="nm">生命保障（100ヵ月・税込）</span><span class="vl" id="sk2-life">—</span></div>
 <div class="skip-row"><span class="nm">金利・手数料</span><span class="vl gold">無料</span></div>
 <div class="skip-row"><span class="nm">お支払い開始</span><span class="vl gold">3ヶ月後〜</span></div>
 <div class="skip-total">
 <div class="lbl">当日＋生命保障 合計（税込）</div>
 <div class="amt" id="sk2-total">—</div>
 </div>
 </div>
 </div>

 </div>
 <div class="skip-note">
 <span class="icon"> </span>
 <span>スキップローンは生命保障100ヵ月が必須条件です。金利・手数料は無料で、お支払いは3ヶ月後からスタートします。フード定期プランとの併用が可能ですが、あんしんMAX70%割との併用はできません。</span>
 </div>
</div>

<button class="print-btn no-print" onclick="window.print()"> この見積もりを印刷する</button>
```

 </div>

</div>

<script>
// ============================================================
// 状態管理：割引上限(discountCap)を明示的に管理
// ============================================================
var gVaccine = 'ワクチン1回';
var gLife = '24ヵ月';
var gGene = '追加項目なし';
var gCert = '対象外';
var gFood = '5年プラン';
var gWeight = '猫';
var gCap = 80000; // ← 割引上限（猫・〜10kgは8万, 15〜20kgは16万, 30〜40kgは20万）

function selectChip(el, groupId, key) {
 document.querySelectorAll('#' + groupId + ' .chip').forEach(function(c){ c.classList.remove('active'); });
 el.classList.add('active');
 var v = el.dataset.val;
 if (key === 'vaccine') gVaccine = v;
 else if (key === 'life') gLife = v;
 else if (key === 'gene') gGene = v;
 else if (key === 'cert') gCert = v;
 else if (key === 'food') gFood = v;
 calc();
}

function selectWeight(el, weightVal, capVal) {
 document.querySelectorAll('#weightGroup .weight-chip').forEach(function(c){ c.classList.remove('active'); });
 el.classList.add('active');
 gWeight = weightVal;
 gCap = capVal; // ← 直接引数で数値を受け取り確実に設定

 var badge = document.getElementById('capBadge');
 if (capVal === 80000) badge.textContent = ' 現在の割引上限：¥80,000（猫・〜10kg）';
 if (capVal === 160000) badge.textContent = ' 現在の割引上限：¥160,000（15kg〜20kg）';
 if (capVal === 200000) badge.textContent = ' 現在の割引上限：¥200,000（30kg〜40kg）';
 calc();
}

// ============================================================
// 計算ヘルパー
// ============================================================
function packCost(v) {
 if (v === 'ワクチン3回') return 82000;
 if (v === 'ワクチン2回') return 75000;
 return 68000;
}

function lifeRate(l) {
 var map = {'1ヵ月':0.10,'3ヵ月':0.15,'6ヵ月':0.20,'12ヵ月':0.25,'24ヵ月':0.30,'36ヵ月':0.35,'60ヵ月':0.40,'100ヵ月':0.50};
 return map[l] || 0.30;
}

function geneCost(g) {
 if (g === '追加2項目') return 8000;
 if (g === '追加1項目') return 5000;
 return 0;
}

function certCost(c) {
 return c === '検査有' ? 1000 : 0;
}

/**
 * フード割引額を計算（上限キャップ適用済み）
 * cap は必ず外部から渡すこと
 */
function calcFoodDisc(seiba, vaccine, plan, cap) {
 // エクセル式準拠：ワクチン回数関係なく常に(seiba+pack)を基準に計算
 var pack = packCost(vaccine);
 var raw = 0;
 if (plan === '5年プラン') raw = (seiba + pack) * 0.50;
 else if (plan === '3年プラン') raw = (seiba + pack) * 0.15;
 else if (plan === '1年プラン') raw = (seiba + pack) * 0.05;
 return raw > cap ? cap : raw;
}

function fmt(n) {
 if (n === null || n === undefined || isNaN(n)) return '—';
 return '¥' + Math.round(n).toLocaleString('ja-JP');
}

function fmtNeg(n) {
 var v = Math.abs(Math.round(n));
 return v === 0 ? '¥0' : '▲¥' + v.toLocaleString('ja-JP');
}

function setText(id, val) {
 var el = document.getElementById(id);
 if (el) el.textContent = val;
}

// ============================================================
// メイン計算
// ============================================================
function calc() {
 var seiba = parseFloat(document.getElementById('price').value) || 0;
 var kenreg = parseFloat(document.getElementById('kenreg').value) || 0;
 var seibaname = document.getElementById('seibaname').value || '—';
 var staff = document.getElementById('staff').value || '—';
 var seibanumber = document.getElementById('seibanumber').value || '—';

 document.getElementById('resultSubtitle').textContent =
 '生体名：' + seibaname + ' (' + seibanumber + ')　｜　担当：' + staff + '　｜　フードコース：' + gWeight;

 var pack = packCost(gVaccine);
 var lr = lifeRate(gLife);
 var gc = geneCost(gGene);
 var cc = certCost(gCert);
 var cap = gCap; // ← この時点で確定した上限

 // ── Plan 1: 割引なし ──────────────────────────────
 var p1Life = (seiba + pack) * lr;
 var p1Sub = seiba + pack + p1Life + gc + cc + kenreg;
 var p1Tax = p1Sub * 0.1;
 setText('p1-seiba', fmt(seiba));
 setText('p1-pack', fmt(pack));
 setText('p1-life', fmt(p1Life));
 setText('p1-gene', fmt(gc));
 setText('p1-cert', fmt(cc));
 setText('p1-ken', fmt(kenreg));
 setText('p1-sub', fmt(p1Sub));
 setText('p1-tax', fmt(p1Tax));
 setText('p1-total', fmt(p1Sub + p1Tax));

 // ── Plan 2: フード定期プラン ──────────────────────
 var p2Life = (seiba + pack) * lr;
 var p2Sub = seiba + pack + p2Life + gc + cc + kenreg;
 var p2Tax = p2Sub * 0.1;
 var p2Disc = calcFoodDisc(seiba, gVaccine, gFood, cap);
 var p2Total = p2Sub + p2Tax - p2Disc;
 var foodLabels = {'5年プラン':'5年プラン 50%割引','3年プラン':'3年プラン 15%割引','1年プラン':'1年プラン 5%割引','なし':'割引なし'};
 setText('p2-planlabel', foodLabels[gFood] || '');
 setText('p2-seiba', fmt(seiba));
 setText('p2-pack', fmt(pack));
 setText('p2-life', fmt(p2Life));
 setText('p2-gene', fmt(gc));
 setText('p2-cert', fmt(cc));
 setText('p2-ken', fmt(kenreg));
 setText('p2-sub', fmt(p2Sub));
 setText('p2-tax', fmt(p2Tax));
 setText('p2-disc', fmtNeg(p2Disc));
 setText('p2-total', fmt(p2Total));

 // ── Plan 3: あんしんMAX70%割 ──────────────────────
 // 生命保障はカード払いで別途（当日精算から除外）
 var p3Sub = seiba + pack + gc + cc + kenreg;
 var p3Tax = p3Sub * 0.1;

 // フード5年割引（上限キャップ適用）
 var p3FoodDisc = calcFoodDisc(seiba, gVaccine, '5年プラン', cap);

 // あんしんMAX追加割引：エクセル式準拠
 // ワクチン1,2回: (seiba - フード割引額) × 25%
 // ワクチン3回: (seiba - MIN(cap, seiba*50%)) × 25% ← エクセルはcap=8万固定だが cap変数を使用
 var p3MaxBase = seiba - p3FoodDisc;
 var p3MaxDisc = p3MaxBase * 0.25;

 var p3DayTotal = p3Sub + p3Tax - p3FoodDisc - p3MaxDisc;

 // 生命保障は選択した保障期間で税込表示
 // あんしんMAXプランは生命保障100ヶ月が必須（他の選択に関わらず固定）
 var p3LifeRate = 0.50; // 100ヶ月固定 = 50%
 var p3LifeAmt = (seiba + pack) * p3LifeRate * 1.1;
 var p3Grand = p3DayTotal + p3LifeAmt;

 setText('p3-seiba', fmt(seiba));
 setText('p3-pack', fmt(pack));
 setText('p3-gene', fmt(gc));
 setText('p3-cert', fmt(cc));
 setText('p3-ken', fmt(kenreg));
 setText('p3-sub', fmt(p3Sub));
 setText('p3-tax', fmt(p3Tax));
 setText('p3-fooddisc', fmtNeg(p3FoodDisc));
 setText('p3-maxdisc', fmtNeg(p3MaxDisc));
 setText('p3-daytotal', fmt(p3DayTotal));
 setText('p3-life', fmt(p3LifeAmt) + '（100ヵ月・固定）');
 setText('p3-grandtotal',fmt(p3Grand));

 // スキップローン計算
 calcSkip(seiba, pack, gc, cc, kenreg, lr, cap);
}

// ============================================================
// スキップローン計算
// ============================================================
function calcSkip(seiba, pack, gc, cc, kenreg, lr, cap) {
 var lifeRate100 = 0.50; // 100ヵ月固定
 var lifeTaxed = (seiba + pack) * lifeRate100 * 1.1;

 // ── スキップA: 割引なし＋スキップローン ──
 var skA_sub = seiba + pack + gc + cc + kenreg;
 var skA_tax = skA_sub * 0.1;
 var skA_day = skA_sub + skA_tax;
 var skA_total = skA_day + lifeTaxed;
 setText('sk1-day', fmt(skA_day));
 setText('sk1-life', fmt(lifeTaxed));
 setText('sk1-total', fmt(skA_total));

 // ── スキップB: フード定期＋スキップローン ──
 var skB_foodDisc = calcFoodDisc(seiba, gVaccine, gFood, cap);
 var skB_sub = seiba + pack + gc + cc + kenreg;
 var skB_tax = skB_sub * 0.1;
 var skB_day = skB_sub + skB_tax - skB_foodDisc;
 var skB_total = skB_day + lifeTaxed;
 setText('sk2-disc', fmtNeg(skB_foodDisc));
 setText('sk2-day', fmt(skB_day));
 setText('sk2-life', fmt(lifeTaxed));
 setText('sk2-total', fmt(skB_total));
}

// 初期表示
calc();
</script>

</body>
</html>
